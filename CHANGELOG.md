# 更新日志

本文档记录了基于 PaddleOCR 项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [0.3.0] - 2025-09-24

### ✨ 新增功能
- **多格式输出支持**：新增Markdown格式输出，支持纯文本和Markdown格式切换
- **智能文本结构分析**：自动识别标题、段落、列表等文档结构元素
- **Markdown实时预览**：支持原始代码、预览和并排三种视图模式
- **文件下载功能**：支持下载TXT和MD格式文件，文件名包含时间戳
- **键盘快捷键**：
  - `Ctrl+1/2`：切换文本/Markdown格式
  - `Ctrl+D`：下载当前格式文件
  - `Alt+1/2/3`：切换Markdown视图模式
- **格式转换API**：新增`/api/convert-format`和`/api/download-result`接口

### 🎨 界面改进
- **格式选择器**：在结果区域添加格式切换按钮
- **Markdown控制面板**：视图切换、下载按钮等控制选项
- **移动端优化**：完全重构移动端界面，支持触摸友好操作
- **工具提示**：为所有按钮添加快捷键提示
- **加载状态指示**：格式转换时显示进度条和加载动画
- **快捷键反馈**：使用快捷键时显示操作反馈提示

### 🚀 性能优化
- **文本分析缓存**：实现LRU缓存机制，提升重复分析性能
- **格式转换缓存**：缓存转换结果，避免重复计算
- **预编译正则表达式**：优化文本模式匹配性能
- **批量处理优化**：优化大文本处理的内存使用
- **性能监控**：添加转换时间统计和性能指标

### 🏗️ 架构改进
- **模块化设计**：新增`core`模块，包含文本处理和文档处理子模块
- **前端模块化**：JavaScript代码模块化，提升可维护性
- **异常处理系统**：完善的自定义异常类和错误处理机制
- **代码结构优化**：清晰的功能分层和职责分离

### 📱 移动端优化
- **响应式布局**：完全重构移动端布局，适配各种屏幕尺寸
- **触摸友好**：按钮大小符合触摸标准，支持触摸反馈
- **手势支持**：优化触摸操作体验
- **性能优化**：减少移动端动画，支持减少动画偏好

### 🔧 技术特性
- **智能文本分析**：
  - 标题检测：基于长度、位置、内容特征识别标题层级
  - 列表检测：支持有序、无序列表及嵌套层级
  - 段落提取：智能分割段落，保持文档结构
- **Markdown转换**：
  - 标题格式化：自动生成`#`标记
  - 列表格式化：转换为标准Markdown列表语法
  - 特殊字符转义：确保Markdown格式正确性
- **文件管理**：
  - 临时文件创建和清理
  - 智能文件名生成
  - 多格式文件下载支持

### 🐛 问题修复
- **格式转换错误处理**：完善的错误处理和回退机制
- **内存泄漏修复**：优化大文本处理的内存使用
- **移动端兼容性**：修复移动端显示和操作问题
- **缓存一致性**：确保缓存数据的一致性和有效性

### 📊 API增强
- **新增接口**：
  ```
  POST /api/convert-format - 格式转换
  POST /api/download-result - 文件下载
  ```
- **响应格式增强**：添加结构分析信息、转换时间等元数据
- **错误处理改进**：更详细的错误信息和状态码

### 🎯 用户体验
- **操作反馈**：所有操作都有明确的视觉反馈
- **错误提示**：友好的错误信息和解决建议
- **加载状态**：清晰的加载进度和状态指示
- **无障碍支持**：键盘导航和高对比度模式支持

## [0.2.0] - 2025-09-23

### ✨ 新增功能
- **模型信息显示**：在系统信息面板中显示所有已下载的模型版本和大小
- **当前模型标识**：清晰标识当前正在使用的模型组合
- **网站图标**：添加了自定义的 SVG favicon，提升品牌识别度

### 🎨 界面改进
- **布局优化**：调整系统信息面板布局，将模型信息移至支持格式下方
- **信息展示**：详细显示每个模型的名称、版本、类型和文件大小
- **总大小统计**：显示所有模型文件的总大小
- **视觉标识**：为当前使用的模型添加绿色"当前"标签

### 🔧 技术改进
- **模型检测逻辑**：优化模型检测算法，准确识别 PaddleX 和传统 v4 模型
- **智能选择**：自动选择最适合的模型组合（优先使用 mobile 版本）
- **API 增强**：`/api/status` 接口新增 `models_info` 字段

### 📊 模型支持
- **PaddleX 模型**：完整支持 PaddleOCR 3.x 的新模型格式
- **传统模型**：向下兼容 PP-OCRv4 检测、识别、分类模型
- **混合环境**：智能处理同时存在多种模型的情况

### 🐛 问题修复
- **模型标识**：修复了所有模型都被标记为"当前"的问题
- **逻辑优化**：改进模型选择逻辑，确保只有实际使用的模型被标记

## [0.1.0] - 2025-09-23

### 🎉 首个发布版本

这是 paddleocr 的首个可用版本，基于 PaddleOCR 3.x 进行了全面优化。

### ✨ 新增功能
- 基于 PaddleOCR 3.x 的在线文字识别系统
- 现代化 Web 界面，支持拖拽上传
- 智能 OCR 服务初始化和模型管理
- 自动模型下载和缓存机制
- 实时处理状态显示
- 一键复制识别结果
- 临时文件自动清理

### 🚀 性能优化
- **极速启动**：应用启动时间优化到 3 秒内
- **快速识别**：单张图片识别时间 5-10 秒
- **轻量级模型**：使用 PP-OCRv4_mobile 系列模型
- **CPU 优化**：专门针对 CPU 模式深度优化
- **内存管理**：优化内存使用和垃圾回收

### 🎨 用户界面
- 响应式设计，支持移动端访问
- Bootstrap 5 + 自定义 CSS 样式
- 直观的状态指示器
- 友好的错误提示和帮助信息
- 实时的处理进度反馈

### 🔧 技术特性
- **架构现代化**：模板和静态文件分离
- **API 优化**：基于 PaddleOCR 3.x 最新 API
- **结果解析**：适配新的返回格式
- **错误处理**：完善的异常处理机制
- **日志系统**：详细的调试和运行日志

### 📋 支持特性
- **文件格式**：JPG, PNG, BMP, TIFF
- **文件大小**：最大 16MB
- **识别语言**：中英文混合识别
- **置信度过滤**：自动过滤低置信度结果

### 🛠️ 系统要求
- Python 3.7+（推荐 3.8+）
- 内存 2GB+（推荐 4GB+）
- 磁盘空间 1GB+（用于模型文件）
- 网络连接（首次下载模型）

### 📦 项目结构
```
paddleocr-v0.1/
├── app.py              # 主应用程序
├── requirements.txt    # 依赖包列表
├── README.md          # 项目文档
├── CHANGELOG.md       # 更新日志
├── .gitignore         # Git 忽略文件
├── templates/         # HTML 模板
│   └── index.html
└── static/           # 静态文件
    ├── css/style.css
    └── js/app.js
```

### 🔄 从旧版本迁移
这是首个版本，无需迁移。

### ⚠️ 已知限制
- 仅支持单文件处理（批量处理将在后续版本添加）
- 专注 CPU 模式（GPU 支持将在后续版本添加）
- 输出格式为纯文本（多格式输出将在后续版本添加）

### 🎯 下个版本计划
- [ ] 批量文件处理
- [ ] 多种输出格式（Markdown, HTML, JSON）
- [ ] GPU 加速支持
- [ ] 处理历史记录
- [ ] 配置文件支持
- [ ] 更多图像格式支持
- [ ] API 认证和限流

---

## 版本说明

### 版本号规则
- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 更新类型
- **新增 (Added)**：新功能
- **变更 (Changed)**：对现有功能的变更
- **弃用 (Deprecated)**：不久将移除的功能
- **移除 (Removed)**：已移除的功能
- **修复 (Fixed)**：任何 bug 修复
- **安全 (Security)**：安全相关的修复